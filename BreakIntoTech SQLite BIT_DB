/* Open the customers table and see what columns are availble. */
SELECT * FROM customers LIMIT 5;
/* order_id and acctnum */

/* Open the JanSales table and see what columns are available. */
SELECT * FROM JanSales LIMIT 5;
/* orderID, Product, Quantity, price, orderdate, location */

/* How many orders were placed in January? */
SELECT count(*) FROM JanSales;
/* 9723 */

/* How many of those orders were for an iPhone? */
SELECT count(*) FROM JanSales WHERE Product = "iPhone";
/* 379 */

/* Select the customer account numbers for all the orders that were placed in February. */
SELECT customers.acctnum FROM customers
INNER JOIN FebSales
ON customers.order_id = FebSales.orderID;

/* Which product was the cheapest one sold in January, and what was the price? */
SELECT Product, price FROM JanSales ORDER BY price ASC LIMIT 1;
/* AAA Batteries (4-pack) $2.99 */

/* What is the total revenue for each product sold in January? */
SELECT SUM(quantity)*price as revenue, product FROM JanSales GROUP BY Product;

/* Which products were sold in February at 548 Lincoln St, Seattle, WA 98101,
how many of each were sold,
and what was the total revenue? */
SELECT Product, sum(Quantity), SUM(quantity)*price as revenue, location FROM FebSales
WHERE location LIKE "%548 Lincoln St%" GROUP BY Product;

/* How many customers ordered more than 2 products at a time in February,
and what was the average amount spent for those customers? */
SELECT count(customers.acctnum), avg(quantity)*price
FROM FebSales
JOIN customers
ON FebSales.orderID = customers.order_id
WHERE FebSales.quantity >2;
/* Customer count = 890, AVG spend for them is $3.99 */
